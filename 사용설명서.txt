╔═══════════════════════════════════════════════════════════════╗
║                                                               ║
║          PDF 자동 이메일 발송 프로그램 사용설명서              ║
║                                                               ║
╚═══════════════════════════════════════════════════════════════╝


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 🚀 빠른 시작 (2단계로 바로 사용하기!)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1단계: "전송할PDF" 폴더에 PDF 파일 넣기
       ✅ 회사명___파일명.pdf
       ✅ 회사명.pdf
       ✅ 폴더 안에 PDF들을 넣어도 됨 (하위 폴더까지 자동 탐색!)

2단계: "실행.bat" 더블클릭
       → Enter 누르거나 10초 기다리면 자동 실행
       → 끝! 이메일 자동 발송됨!


📝 PDF 파일 이름 규칙:
   ✅ "회사명___내용.pdf" (언더스코어 3개)
   ✅ "회사명.pdf" (회사명만)
   
   예시:
   - 두요니네 회사___2026_1분기.pdf ✅
   - 원하네 회사___보고서.pdf ✅
   - 아린이네 회사.pdf ✅


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 📋 기본 사용법
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

▶ 가장 쉬운 사용법 (추천!)
   
   1. "전송할PDF" 폴더에 PDF 파일들 넣기
      - 여러 개 한꺼번에 넣어도 OK
      - 폴더 안에 폴더 만들어도 OK (자동으로 찾음)
      - 같은 회사 파일 여러 개 → 한 이메일에 모두 첨부!
   
   2. "실행.bat" 더블클릭
      - 10초 카운트다운 시작
      - Enter 누르면 바로 실행
      - 그냥 기다려도 자동 실행
   
   3. 발송 확인 화면
      - 어떤 회사에 몇 개 보낼지 확인
      - Enter 누르면 발송 시작
      - 10초 기다려도 자동 발송
   
   4. 완료!
      - 발송된 파일은 "전송완료" 폴더로 자동 이동


▶ 프로그램 실행 옵션
   
   실행 방법:
   - Windows: "실행.bat" 더블클릭
   
   모드 선택 (10초 후 자동으로 1번 실행):
   - 1번: 현재 PDF 파일 일괄 처리 (추천)
   - 2번: 자동 감시 모드 (계속 켜두고 사용)
   - 3번: 종료


▶ 자동 감시 모드 (2번)
   
   프로그램을 계속 켜두고 사용:
   - PDF 넣으면 자동으로 바로 발송
   - 종료: Ctrl + C


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 ⚠️ 중요 유의사항
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. PDF 파일명 규칙
   
   ✅ 올바른 예:
      두요니네 회사___2026_1분기.pdf
      원하네 회사___보고서.pdf
      아린이네 회사.pdf
   
   ❌ 잘못된 예:
      2024___두요니네 회사.pdf    (회사명이 첫 번째가 아님)
      보고서___두요니네 회사.pdf  (회사명이 뒤에)


2. 회사명에 사용 가능한 문자
   ✅ 한글, 영문, 숫자, 공백, 특수문자 사용 가능
   ✅ 예: "두요니네 회사", "Samsung Electronics"


3. 구분자는 ___ (언더스코어 3개) 또는 생략 가능


4. 폴더 구조
   전송할PDF/
   ├── 회사A.pdf                  ✅ OK
   ├── 2024/
   │   └── 회사B___보고서.pdf    ✅ OK (하위 폴더도 자동 탐색)
   └── 중요문서/
       └── 1분기/
           └── 회사C.pdf          ✅ OK (깊은 폴더도 OK)


5. 한 회사에 여러 파일
   - 같은 회사명의 PDF가 여러 개면 한 이메일에 모두 첨부
   - 예: "두요니네 회사___파일1.pdf", "두요니네 회사___파일2.pdf"
        → 1개 이메일에 2개 파일 첨부


6. 처음 사용 전 필수 설정
   → "설정" 폴더의 파일들을 먼저 수정하세요!


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 ⚙️ 처음 사용 시 필수 설정 (관리자용)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

"설정" 폴더 안의 파일들을 수정하세요:


┌─────────────────────────────────────────────────────────────┐
│ 1. 이메일설정.txt - Gmail 계정 설정 (필수!)                  │
└─────────────────────────────────────────────────────────────┘

   sender_email=your_email@gmail.com       ← 본인 Gmail로 변경
   sender_password=your_app_password       ← 앱 비밀번호 입력

   Gmail 앱 비밀번호 만들기:
   1. 2단계 인증 활성화 (https://myaccount.google.com/security)
   2. 앱 비밀번호 생성 (https://myaccount.google.com/apppasswords)
   3. 로그인 후 "앱 비밀번호 생성" 클릭
   4. 생성된 16자리 코드 복사
   5. 위 sender_password에 붙여넣기
   
   ⚠️ 2단계 인증이 활성화되어 있지 않으면 앱 비밀번호를 만들 수 없습니다!
   ⚠️ 자세한 설정 방법은 "설정/이메일설정.txt" 파일을 참조하세요!


┌─────────────────────────────────────────────────────────────┐
│ 2. 회사_이메일_양식_DB.txt - 회사 정보 등록                   │
└─────────────────────────────────────────────────────────────┘

   형식 (3줄 한 세트):
   
   고유회사명=삼성전자
   보낼이메일=samsung@company.com, samsung2@company.com
   적용할양식=이메일양식A
   
   (빈 줄)
   
   고유회사명=LG전자
   보낼이메일=lg@company.com
   적용할양식=이메일양식B

   ※ 회사 정보 사이에 빈 줄 필수!
   ※ 여러 이메일은 쉼표(,)로 구분 (공백은 자동 제거됨)


┌─────────────────────────────────────────────────────────────┐
│ 3. 이메일양식.txt - 발송할 이메일 내용 (선택사항)             │
└─────────────────────────────────────────────────────────────┘

   기본 제공되는 양식 3개:
   - 이메일양식A: 공식적인 양식
   - 이메일양식B: 정중한 양식
   - 이메일양식C: 간결한 양식
   
   필요시 직접 수정하거나 새로운 양식을 추가할 수 있습니다


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 🔧 문제 해결
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Q: "Python이 설치되어 있지 않습니다" 오류
A: → Python 설치하기 (https://www.python.org)
   또는 dist/PDF이메일발송.exe 사용하기

Q: 이메일이 발송되지 않아요
A: 1. "프로그램/email_sender.log" 파일 열어서 오류 확인
   2. "설정/이메일설정.txt" 파일 확인
      - sender_email이 실제 이메일로 변경되었나?
      - sender_password가 앱 비밀번호로 입력되었나?
   3. 인터넷 연결 확인

Q: "회사명을 추출할 수 없습니다" 오류
A: → PDF 파일명이 회사명으로 시작하는지 확인
   → 회사명 바로 뒤에 ___ (언더스코어 3개) 또는 .pdf로 끝나는지 확인

Q: "회사 정보를 찾을 수 없습니다" 오류
A: → "설정/회사_이메일_양식_DB.txt" 열기
   → 해당 회사가 등록되어 있는지 확인
   → 회사명 철자가 PDF 파일명과 정확히 일치하는지 확인
   → 공백, 대소문자 주의!

Q: 프로그램이 멈췄어요
A: → Ctrl + C 눌러서 종료
   → "프로그램/email_sender.log" 파일에서 오류 확인


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 📁 폴더 설명
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

실행.bat           프로그램 실행 파일 (더블클릭!)
전송할PDF/          PDF 파일을 여기에 넣으세요!
전송완료/           발송 완료된 파일이 자동으로 이동됩니다
설정/               사용자가 수정할 설정 파일들
프로그램/           Python 코드 (수정 불필요)


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 💡 팁
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✓ Enter 누르거나 기다리면 자동 실행!
  → 10초 카운트다운 후 자동으로 진행

✓ 하위 폴더에 PDF를 넣어도 자동으로 찾음
  → 폴더 구조 자유롭게 정리 가능

✓ 같은 회사 파일 여러 개는 한 이메일로!
  → 여러 번 보내지 않고 한 번에 첨부

✓ 자동 실행 시간 조정 가능
  → "설정/설정.txt"에서 auto_select_timeout, auto_send_timeout 수정
  → 양수: 해당 초만큼 대기
  → 0: 즉시 실행
  → 음수: 비활성화 (수동 입력 필요)

✓ 로그 확인
  → "프로그램/email_sender.log"에서 실행 기록 확인

✓ 테스트는 본인 이메일로!
  → 실제 발송 전에 본인 이메일로 테스트해보세요

✓ 백업을 잊지 마세요
  → 설정 파일들을 다른 곳에 복사해두세요


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 📖 더 자세한 설명
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

▶ 프로그램 동작 방식

   1. PDF 파일명에서 회사명 추출
      예: "삼성전자___보고서.pdf" → "삼성전자"
   
   2. 회사_이메일_양식_DB.txt에서 회사 정보 조회
      → 이메일 주소 확인
      → 사용할 이메일 양식 확인
   
   3. 이메일양식.txt에서 양식 가져오기
      → {회사명}, {파일명}, {날짜}, {시간} 자동 채우기
   
   4. 이메일 발송
      → SMTP 서버 통해 전송
   
   5. 파일 이동
      → "전송완료" 폴더로 이동


▶ 이메일 양식 변수

   {회사명}  → PDF에서 추출된 회사명
   {파일명}  → PDF 파일의 전체 이름
   {날짜}    → 발송 날짜 (예: 2024년 10월 16일)
   {시간}    → 발송 시간 (예: 14:30:25)


▶ 다중 이메일 양식 사용

   회사마다 다른 양식을 적용할 수 있습니다:
   
   삼성전자 → 이메일양식A (공식적)
   LG전자 → 이메일양식B (정중)
   현대자동차 → 이메일양식C (간결)


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 🔐 보안 주의사항
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

⚠️  "설정/이메일설정.txt"에는 이메일 비밀번호가 있습니다!

• 다른 사람과 공유하지 마세요
• Git에 업로드하지 마세요
• 주기적으로 비밀번호를 변경하세요
• Gmail 앱 비밀번호를 사용하세요 (실제 비밀번호 아님!)


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 📞 추가 도움이 필요하신가요?
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 프로그램/email_sender.log 파일을 확인하세요
   → 대부분의 오류 원인을 알 수 있습니다

2. 설정 파일들을 다시 한 번 확인하세요
   → 오타, 공백, 형식 오류가 없는지

3. "설정" 폴더의 각 설정 파일을 참고하세요
   → 상세한 작성 방법과 예시가 있습니다

4. 문제 해결이 안 되거나 새로운 기능이 필요하신가요?
   → watual257@gmail.com 으로 문의해주세요
   
   문의 시 포함해주시면 좋은 정보:
   - 어떤 문제가 발생했는지
   - "프로그램/email_sender.log" 파일 내용
   - 어떤 기능을 추가하고 싶으신지


╔═══════════════════════════════════════════════════════════════╗
║                                                               ║
║              쉽고 편리하게 사용하세요! 😊                      ║
║                                                               ║
╚═══════════════════════════════════════════════════════════════╝

